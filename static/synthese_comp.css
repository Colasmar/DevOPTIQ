/* ======================================================================
   Global
====================================================================== */
body {
  font-family: Arial, sans-serif;
  background-color: #f4f4f4;
  margin: 0;
  padding: 20px;
  color: #333;
}

h1, h3, h4 { margin-top: 20px; }

.hidden { display: none; }

/* ======================================================================
   En-têtes cliquables (Rôles / Activités) (bleu)
====================================================================== */
h3.toggle-role,
h4.toggle-activity {
  cursor: pointer;
  background-color: #007bff;
  color: #fff;
  padding: 10px;
  margin: 0;
  border-radius: 4px;
}
h4.toggle-activity { background-color: #0069d9; }

/* ======================================================================
   Sections Rôle / Activité
====================================================================== */
.role-section,
.activity-section {
  margin-bottom: 20px;
  border: 1px solid #ccc;
  background-color: #fff;
  border-radius: 6px;
  box-shadow: 0 2px 5px rgba(0,0,0,0.05);
  overflow: hidden;
}
.role-content,
.activity-content { padding: 15px; }

/* ======================================================================
   Tableaux (évaluations / synthèse / connaissances)
====================================================================== */
.eval-table, .synthesis-table, .knowledge-table {
  width: 100%;
  border-collapse: collapse;
  margin-top: 10px;
  margin-bottom: 20px;
}

.eval-table caption {
  text-align: left;
  font-weight: bold;
  padding: 5px;
  font-size: 1.1em;
  background-color: #eee;
  border: 1px solid #ccc;
  border-bottom: none;
}

.eval-table th, .eval-table td,
.synthesis-table th, .synthesis-table td,
.knowledge-table th, .knowledge-table td {
  border: 1px solid #ccc;
  padding: 8px;
  text-align: center;
}

.synthesis-table th { background-color: #f2f2f2; }

.eval-table th.green { background-color: #a3f7a3 !important; }

/* ======================================================================
   Cellules d’évaluation + dates
====================================================================== */
.eval-cell {
  cursor: pointer;
  min-width: 60px;
  height: 30px;
  transition: background-color 0.3s;
  position: relative;
}

.eval-cell.red    { background-color: #ff6767; }
.eval-cell.orange { background-color: #f8b95a; }
.eval-cell.green  { background-color: #6aff6a; }

.note-date {
  font-size: 0.65em;
  margin-top: 2px;
  color: #333;
  pointer-events: none;
}

/* Synthèse globale : lecture seule */
#global-summary-section .eval-cell { pointer-events: none; }

/* ======================================================================
   Commandes
====================================================================== */
#save-competencies-button {
  margin-top: 20px;
  padding: 12px 24px;
  background-color: #28a745;
  border: none;
  color: #fff;
  border-radius: 5px;
  font-size: 1em;
  cursor: pointer;
}
#save-competencies-button:hover { background-color: #218838; }

select {
  padding: 6px 10px;
  margin-right: 10px;
}

main > div:first-of-type { margin-bottom: 20px; }

.connections-outgoing {
  margin-top: 10px;
  padding-left: 20px;
  border-left: 2px solid #eee;
  font-size: 0.9em;
  color: #555;
}

/* ======================================================================
   Modale Historique
====================================================================== */
.modal {
  position: fixed;
  inset: 0;
  background: rgba(0,0,0,0.6);
  display: flex;
  justify-content: center;
  align-items: center;
  z-index: 10;
}
.modal.hidden { display: none; }

.modal-content {
  background: #fff;
  padding: 20px;
  width: min(1120px, calc(100vw - 40px)); /* large & responsive */
  max-height: 75vh;
  overflow-y: auto;
  border-radius: 12px;
  position: relative;
  box-shadow: 0 24px 60px rgba(0,0,0,0.2);
}
.close-history {
  position: absolute;
  top: 8px;
  right: 12px;
  font-size: 20px;
  cursor: pointer;
}

/* ======================================================================
   Performances — Version verte “pomme”
====================================================================== */
.perf-wrapper { margin-top: 16px; }

.perf-card {
  border: 1px solid #e6e8eb;
  border-radius: 16px;
  background: #ffffff;
  box-shadow: 0 8px 20px rgba(17, 24, 39, 0.06);
  padding: 14px;
}

.perf-header {
  display: flex;
  align-items: center;
  justify-content: space-between;
  margin-bottom: 12px;
  border-radius: 12px;
  padding: 10px 12px;
  color: #12391a;
  background: linear-gradient(90deg, #a8f27a 0%, #7bdc48 100%);
  box-shadow: inset 0 0 0 1px rgba(18,57,26,0.06);
}
.perf-title {
  display: flex; align-items: center; gap: 10px;
  font-weight: 800; letter-spacing: .2px;
}
.perf-icon { fill: #12391a; opacity: .9; }
.perf-actions { display: flex; gap: 8px; }

.perf-btn {
  border: 1px solid transparent;
  padding: 7px 12px;
  border-radius: 999px;
  font-size: 14px;
  cursor: pointer;
  transition: transform .12s ease, box-shadow .12s ease, background-color .2s, border-color .2s;
  box-shadow: 0 1px 6px rgba(0,0,0,.05);
}
.perf-btn:active { transform: translateY(1px); }

.perf-btn-primary { background: #22c55e; color: #0b1e10; border-color: #16a34a; }
.perf-btn-primary:hover { background: #16a34a; color:#08180c; }

.perf-btn-outline { background: #ffffff; color: #0f172a; border-color: #d1d5db; }
.perf-btn-outline:hover { background: #f3f4f6; }

.perf-btn-danger { background: #ef4444; color: #fff; border-color: #ef4444; }
.perf-btn-danger:hover { background: #dc2626; }

.perf-content { display: grid; gap: 14px; }

.perf-subtitle {
  font-weight: 800;
  color: #12391a;
  margin: 6px 0;
  letter-spacing: .2px;
}

.perf-box {
  border: 1px solid #e5e7eb;
  border-radius: 14px;
  padding: 12px;
  background: #ffffff;
  box-shadow: 0 2px 10px rgba(0,0,0,0.04);
}

/* Performance générale */
.perf-general-fragment {
  border-left: 6px solid #22c55e;
  background: linear-gradient(180deg, #f1fdf5 0%, #ffffff 100%);
}
.perf-general-title { color: #0b1e10; font-weight: 100; } /* demandé */
.perf-general-desc { margin-top: 6px; white-space: pre-wrap; color: #122117; }

/* Personnalisées */
.perf-items { display: grid; gap: 12px; }
.perf-item  { display: grid; gap: 10px; }
.perf-item-top {
  display: flex; align-items: center; justify-content: space-between;
  padding-bottom: 6px; border-bottom: 1px dashed #e5e7eb;
}
.perf-content-read { white-space: pre-wrap; line-height: 1.5; color: #111827; }

.perf-badges { display: flex; gap: 8px; align-items: center; }
.perf-badge {
  display: inline-block; padding: 3px 10px; border-radius: 999px;
  font-size: 12px; font-weight: 800; letter-spacing: .2px;
}
.perf-badge-success { background: #dcfce7; color: #166534; box-shadow: inset 0 0 0 1px rgba(22,101,52,.25); }
.perf-badge-muted  { background: #eef2f7; color: #334155; box-shadow: inset 0 0 0 1px rgba(51,65,85,.15); }
.perf-badge-date   { background: #e7f7e7; color: #14532d; box-shadow: inset 0 0 0 1px rgba(20,83,45,.2); }

.perf-item-actions {
  display: none;
  align-items: center;
  gap: 10px;
  flex-wrap: wrap;
}
.perf-radio { display: flex; align-items: center; gap: 6px; font-weight: 600; color:#1b4332; }
.perf-status-date {
  height: 32px;
  border-radius: 10px;
  border: 1px solid #cfe3d4;
  padding: 0 10px;
  background:#ffffff;
}
.perf-item.editing .perf-item-actions { display: flex; }

.perf-editor textarea,
.perf-content-edit textarea {
  width: 100%;
  resize: vertical;
  border-radius: 12px;
  border: 1px solid #cfe3d4;
  padding: 10px 12px;
  font-size: 14px;
  line-height: 1.5;
  background: #fcfffc;
}
.perf-editor .perf-editor-actions,
.perf-edit-actions { display: flex; gap: 10px; margin-top: 10px; }

/* États vides */
.perf-empty {
  color: #5b6b5f;
  font-style: italic;
  background: linear-gradient(180deg, #f5fff5 0%, #ffffff 100%);
  border: 1px dashed #cfe3d4;
  border-radius: 12px;
  padding: 12px;
}

/* ======================================================================
   Toast (notification)
====================================================================== */
#toast-message,
.toast {
  position: fixed;
  bottom: 16px;
  right: 16px;
  background: #065f46;
  color: #fff;
  padding: 10px 14px;
  border-radius: 10px;
  box-shadow: 0 1px 2px rgba(0,0,0,0.12);
  opacity: 0;
  transform: translateY(8px);
  transition: .2s;
  z-index: 10000;
}
#toast-message.show,
.toast.show    { opacity: 1; transform: translateY(0); }
.toast.error,
#toast-message.error   { background: #b91c1c; }
.toast.success,
#toast-message.success { background: #065f46; }

/* ======================================================================
   Timeline (modale Historique)
====================================================================== */
#history-title {
  margin: 0 0 12px 0;
  font-weight: 800;
  color: #0b1e10;
  letter-spacing: .2px;
}

.timeline { position: relative; padding-left: 28px; }
.timeline::before {
  content: ""; position: absolute; left: 10px; top: 0; bottom: 0;
  width: 2px; background: #cfe3d4;
}
.timeline-item { position: relative; margin: 14px 0; }
.timeline-dot {
  position: absolute; left: 5px; width: 12px; height: 12px;
  background: #22c55e; border: 2px solid #ffffff; border-radius: 50%;
  box-shadow: 0 0 0 2px rgba(34,197,94,0.25);
}
.timeline-content {
  background: #ffffff; border: 1px solid #e6e8eb; border-radius: 12px;
  padding: 10px 12px; box-shadow: 0 4px 14px rgba(0,0,0,0.05);
}
.timeline-head {
  font-weight: 700; color: #0b1e10; display:flex; align-items:center; gap:8px; flex-wrap:wrap;
}
.timeline-badge {
  display:inline-block; padding:2px 8px; border-radius:999px; font-size:12px; font-weight:800;
  background:#e7f7e7; color:#14532d; border:1px solid #cfe3d4;
}
.timeline-date { color: #03543f; }
.timeline-event { color: #065f46; }
.timeline-status.ok { color: #166534; }
.timeline-status.ko { color: #7f1d1d; }
.timeline-vdate { color: #365314; }
.timeline-sep { color: #94a3b8; }
.timeline-body { margin-top: 6px; color: #111827; white-space: pre-wrap; }
.timeline-empty {
  color: #5b6b5f; font-style: italic; background: #fcfffc; border: 1px dashed #cfe3d4;
  border-radius: 12px; padding: 12px;
}

/* timeline à l'intérieur d'une perf supprimée => rouge */
details.acc.acc--deleted .timeline::before { background: #fecaca; }
details.acc.acc--deleted .timeline-dot {
  background: #ef4444; box-shadow: 0 0 0 2px rgba(239,68,68,0.25);
}

/* ======================================================================
   Accordéon (Historique global > regroupement par performance)
====================================================================== */
.perf-accordion { display: grid; gap: 10px; }
details.acc {
  border: 1px solid #e6e8eb;
  border-radius: 12px;
  background: #ffffff;
  box-shadow: 0 6px 16px rgba(0,0,0,0.04);
}
details.acc[open] { box-shadow: 0 10px 24px rgba(0,0,0,0.06); }

.acc-summary {
  list-style: none;
  padding: 10px 12px;
  cursor: pointer;
  display: grid;
  grid-template-columns: 1fr auto auto;
  align-items: center;
  gap: 12px;
  border-radius: 12px 12px 0 0;
  background: linear-gradient(90deg, #ecffe3 0%, #e3ffe8 100%); /* vert */
  color: #0b1e10; font-weight: 700;
}
.acc-summary::-webkit-details-marker { display: none; }

.acc-left { display: inline-flex; align-items: center; gap: 8px; min-width: 0; }
.acc-name { max-width: 680px; overflow: hidden; text-overflow: ellipsis; white-space: nowrap; }

.acc-caret {
  width: 9px; height: 9px;
  border-right: 2px solid #0b1e10; border-bottom: 2px solid #0b1e10;
  transform: rotate(-45deg); transition: transform .15s ease;
  display:inline-block;
}
details.acc[open] .acc-caret { transform: rotate(45deg); }

.acc-meta { color: #14532d; font-weight: 600; }

/* état supprimé => rouge */
details.acc.acc--deleted .acc-summary {
  background: linear-gradient(90deg, #fee2e2 0%, #fecaca 100%);
  color: #7f1d1d;
}
details.acc.acc--deleted .acc-caret { border-color: #7f1d1d; }
details.acc.acc--deleted .acc-meta { color: #7f1d1d; }

/* bouton poubelle */
.acc-trash {
  appearance: none;
  display: inline-flex; justify-content: center; align-items: center;
  width: 30px; height: 30px; border-radius: 999px;
  border: 1px solid #e6e8eb; background: #fff; cursor: pointer;
  transition: background-color .15s, box-shadow .15s, transform .05s;
}
.acc-trash svg { fill: #374151; }
.acc-trash:hover { background: #f8fafc; box-shadow: 0 2px 6px rgba(0,0,0,.06); }
.acc-trash:active { transform: translateY(1px); }
details.acc.acc--deleted .acc-trash svg { fill: #7f1d1d; }

/* panneau */
.acc-panel {
  padding: 10px 12px 12px 12px;
  border-top: 1px dashed #e6e8eb;
  background: #ffffff;
  border-radius: 0 0 12px 12px;
}

/* confirmation inline */
.acc-confirm {
  border: 1px solid #fde68a;
  background: #fffbeb;
  color: #78350f;
  border-radius: 10px;
  padding: 10px 12px;
  margin-bottom: 10px;
  display: flex; align-items: center; justify-content: space-between; gap: 12px;
}
.acc-confirm-actions { display: flex; gap: 8px; }
.acc-confirm-btn {
  appearance: none; border: 1px solid #e6e8eb; background: #fff; color: #111827;
  border-radius: 8px; padding: 6px 10px; cursor: pointer;
}
.acc-confirm-btn:hover { background: #f8fafc; }
.acc-confirm-yes { background: #ef4444; color: #fff; border-color: #ef4444; }
.acc-confirm-yes:hover { background: #dc2626; }

/* Responsive tweaks */
@media (max-width: 720px) {
  .acc-name { max-width: 56vw; }
}
